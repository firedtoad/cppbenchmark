# judge if use cmake unity build feature
if (${CMAKE_MAJOR_VERSION} LESS 3 OR ${CMAKE_MINOR_VERSION} LESS 16)
    MESSAGE(STATUS "UNITY BUILD NEEDS CMAKE VERSION >= 3.16, TURN IT OFF, CURRENT VERSION:" ${CMAKE_VERSION})
    SET(CMAKE_UNITY_BUILD OFF)
else()
    if(DEFINED CMAKE_UNITY_BUILD AND CMAKE_UNITY_BUILD STREQUAL "OFF")
        SET(CMAKE_UNITY_BUILD OFF)
    else()
        SET(CMAKE_UNITY_BUILD ON)
    endif()
endif()

if (CMAKE_UNITY_BUILD STREQUAL "ON")
    if(NOT DEFINED CMAKE_UNITY_BUILD_BATCH_SIZE)
        set(CMAKE_UNITY_BUILD_BATCH_SIZE 16)
    endif()
    MESSAGE(STATUS "UNITY BUILD ENABLED FOR THIS PROJECT:${PROJECT_NAME}")
    MESSAGE(STATUS "UNITY BUILD BATCH SIZE IS:" ${CMAKE_UNITY_BUILD_BATCH_SIZE})
endif()
